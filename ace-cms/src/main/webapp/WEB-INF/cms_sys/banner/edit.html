<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title></title>
    <#include "/cms_sys/head.html"/>
    <script type="text/javascript">
        $(function() {
            $("#jvForm").validate();
        });
    </script>
</head>
<body>
<div class="box-positon">
    <div class="rpos">当前位置: 学院管理 - 修改</div>
    <form class="ropt">
        <input type="submit" value="返回列表" onclick="this.form.action='v_list.do';" class="return-button"/>
    </form>
    <div class="clear"/>
</div>
<div class="body-box">
    <script type="text/javascript">
        //上传图片
        function upload(n) {
            var of = $("#uploadFile"+n);
            //检查是否选择了图片
            if(of.val()=="") {
                alert("请先选择图片");
                return;
            }
            //将file移动至上传表单
            $("#fileContent").empty();
            $("#fileContent").append(of);
            //复制一个file放至原处
            $("#ufc"+n).append(of.clone().attr("value",""));
            //修改属性
            $("#uploadFileText"+n).attr("value","");
            of.attr("id","");
            of.attr("name","uploadFile");
            //其他表单
            $("#ufFileName").val($("#fileName"+n).val());
            $("#ufWidth").val($("#zoomWidth"+n).val());
            $("#ufHeight").val($("#zoomHeight"+n).val());
            //先清除
            $("#ufMark").val("");
            $("#ufMark").val($("#mark"+n).val());
            $("#uploadNum").val(n);
            $("#uploadForm").submit();
        }
        //剪裁图片
        function imgCut(n) {
            if($("#uploadImgPath"+n).val()=="") {
                alert("请先上传图片");
                return;
            }
            var url = "../common/v_image_area_select.do?uploadNum="+n+"&imgSrcPath="
                    +$("#uploadImgPath"+n).val()+"&zoomWidth="+$("#zoomWidth"+n).val()+"&zoomHeight="+$("#zoomHeight"+n).val();
            window.open(url,"imgcut","height=550, width=1000, top=0, left=0, toolbar=no, menubar=no, scrollbars=auto, resizable=yes,location=no, status=no");
        }
        //预览图片
        function previewImg(n) {
            var img = $("#uploadImgPath"+n).val();
            if(img!="") {
                if(img.indexOf("?")==-1) {
                    $("#preImg"+n).attr("src",img+"?d="+new Date()*1);
                } else {
                    $("#preImg"+n).attr("src",img+"&d="+new Date()*1);
                }
                if(!$("#preImg"+n).attr("noResize")) {
                    $("#preImg"+n).css("width","auto");
                    $("#preImg"+n).css("height","auto");
                }
            } else {
                $("#preImg"+n).removeAttr("src");
            }
        }
    </script>
    <form id="uploadForm" action="../common/o_upload_image.do" method="post" enctype="multipart/form-data" target="hiddenIframe" style="display:none;width:0px;height:0px;">
        <span id="fileContent"></span>
        <input id="ufWidth" type="hidden" name="zoomWidth"/>
        <input id="ufHeight" type="hidden" name="zoomHeight"/>
        <input id="ufFileName" type="hidden" name="fileName"/>
        <input id="ufMark" type="hidden" name="mark"/>
        <input id="uploadNum" type="hidden" name="uploadNum"/>
    </form>
    <iframe name="hiddenIframe" frameborder="0" border="0" style="display:none;width:0px;height:0px;"></iframe>

    <form method="post" action="o_save.do" id="jvForm">
        <input type="hidden" name="id" value="${banner.id}"/>
        <table width="100%" class="pn-ftable" cellpadding="2" cellspacing="1" border="0">
            <tr>
                <td width="10%" class="pn-flabel pn-flabel-h">标题:</td>
                <td colspan="3" class="pn-fcontent">${banner.title!}</td>
            </tr>
            <tr>
                <td width="10%" class="pn-flabel pn-flabel-h">
                    <span class="pn-frequired">*</span>链接:</td>
                <td colspan="3" class="pn-fcontent">
                    <input type="text" maxlength="50" name="link" vld="{required:true}" value="${banner.link!}" style="width:250px"/>
                </td>
            </tr>
            <tr id="tr-typeImg">
                <td id="typeImg" width="10%" class="pn-flabel">Banner图:</td>
                <td colspan="1" width="40%" class="pn-fcontent">
                    <input type="text" id="uploadImgPath0" name="typeImg" value="${banner.picUrl!}" style="width:220px"/>
                    <input type="button" value="预览" onclick="previewImg(0);" class="preview-button"/>
                    <br/>
                    <span id="ufc0" style="position:relative">
                        <input type='text' id='uploadFileText0' size="14"/>
                        <input class="browse" type='button' value='浏览'/>
                        <input onchange="$('#uploadFileText0').val(this.value)" size="14" type="file" id="uploadFile0" class="file-button"/>
                    </span>
                    <label><input type="checkbox" onclick="$('#mark0').val(this.checked);"/>水印</label>
                    <input type="hidden" id="mark0" value="false"/>
                    <input type="button" value="上传" onclick="upload(0);" class="upload-button"/>
                    <br/>
                    宽: <input type="text" id="zoomWidth0" value="100" size="5"/>
                    高: <input type="text" id="zoomHeight0" value="100" size="5"/>
                    <input type="button" value="裁剪" onclick="imgCut(0);" class="cut-button"/>
                </td>
                <td colspan="2" class="pn-fbutton">
                    <img id="preImg0" alt="预览" style="width:100px;height:70px;background-color:#ccc;border:1px solid #333"/>
                </td>
            </tr>
            <tr>
                <td colspan="4" class="pn-fbutton">
                    <input type="submit" value="提交" class="submit"/> &nbsp; <input type="reset" value="重置" class="reset"/>
                </td>
            </tr>
        </table>
    </form>
</div>
<br>
<br>
<br>
<br>
</body>
</html>